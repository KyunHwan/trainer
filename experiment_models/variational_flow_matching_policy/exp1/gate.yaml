schema_version: 1

params:
  input_dim: 1024
  num_experts: 5
  temperature: 5
  top_k: 3

model:
  graph:
    inputs: [input, iterations, training, use_noise]
    modules:
      vfp_gate:
        _type_: vfp_gate
        input_dim: ${params.input_dim}
        num_experts: ${params.num_experts}
        temperature: ${params.temperature}
        top_k: ${params.top_k}
    nodes:
      - name: gating
        call: module:vfp_gate
        kwargs:
          input: $input
          iterations: $iterations
          training: $training
          use_noise: $use_noise
    outputs: [$gating]
    return: single

