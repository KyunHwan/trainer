schema_version: 1

params:
  num_q_vectors: 8
  vec_dim: 384


model:
  graph:
    inputs: [continuous_vec, train, replacement]
    modules:
      vqvae_codebook:
        _type_: cfg_vqvae_codebook
        num_q_vectors: ${params.num_q_vectors}
        vec_dim: ${params.vec_dim}
    
    nodes:
      - name: codebook_vec
        call: module:vqvae_codebook
        kwargs:
          continuous_vec: $continuous_vec
          train: $train
          replacement: $replacement
    outputs: [$codebook_vec]
    return: single
